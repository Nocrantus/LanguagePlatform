<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Deck Creator</title>
    <link rel="stylesheet" href="/css/base.css" />
    <link rel="stylesheet" href="DeckCreatorFormatting.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka&display=swap" rel="stylesheet">

    
</head>

<body>
    <h1>Create New Deck</h1>
    

    <button class="logout-btn" onclick="logout()">Log Out</button>

    <label for="name">Name of Deck:</label>
    <input type="text" id="name" name="name" required minlength="4" maxlength="20" size="20"/>

    <br><br>

    <table id="terms-table">
        <thead>
            <tr>
                <th>Term</th>
                <th>Definition</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="text" class="term-input"></td>
                <td><input type="text" class="def-input"></td>
            </tr>
        </tbody>
    </table>

    <button onclick="addTerm()">Add Term</button>
    <button onclick="createFlashcards()">Create Flashcards</button>
    <div class="back-to-home">
        <button onclick="window.location.href='../index.html';">Back to Home Page</button>
    </div>

    <div class="flashcard-section">
        <div class="flashcard-viewer" id="flashcard-viewer" style="display:none">
          <div class="flashcard" id="flashcard" onclick="flipCard()">
            <div class="flashcard-inner" id="flashcard-inner">
              <div class="flashcard-front" id="card-front"></div>
              <div class="flashcard-back" id="card-back"></div>
            </div>
          </div>
          <div class="nav-buttons">
            <button onclick="prevCard()">←</button>
            <span id="card-counter">Card 1 of 1</span>
            <button onclick="nextCard()">→</button>
          </div>
        </div>
      </div>

      <script>
        let flashcards = [];
        let currentIndex = 0;
    
        document.getElementById("name").addEventListener("input", function () {
            localStorage.setItem("deckName", this.value);
        });
    
        window.onload = function () {
            const savedName = localStorage.getItem("deckName");
            if (savedName) document.getElementById("name").value = savedName;
        };
    
        function addTerm() {
            const table = document.getElementById("terms-table").getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `
                <td><input type="text" class="term-input"></td>
                <td><input type="text" class="def-input"></td>
            `;
        }
    
        function createFlashcards() {
            const terms = Array.from(document.getElementsByClassName('term-input')).map(input => input.value.trim());
            const defs = Array.from(document.getElementsByClassName('def-input')).map(input => input.value.trim());
    
            flashcards = terms.map((term, i) => ({
                term,
                def: defs[i]
            }));
    
            if (flashcards.length === 0 || flashcards.some(card => !card.term || !card.def)) {
                alert("Please enter at least one valid term and definition.");
                return;
            }
    
            // Save deck to localStorage
            const deckName = document.getElementById("name").value;
            const newDeck = {
                name: deckName,
                type: "Flashcards",
                modified: new Date().toLocaleDateString(),
                cards: flashcards
            };
    
            const allDecks = JSON.parse(localStorage.getItem("decks")) || [];
            allDecks.push(newDeck);
            localStorage.setItem("decks", JSON.stringify(allDecks));
    
            // Start flashcard viewer
            currentIndex = 0;
            showCard();
            document.getElementById("flashcard-viewer").style.display = "block";
            alert("Deck saved successfully!");
        }
    
        function showCard() {
            const card = flashcards[currentIndex];
            document.getElementById("card-front").textContent = card.term;
            document.getElementById("card-back").textContent = card.def;
            document.getElementById("card-counter").textContent = `Card ${currentIndex + 1} of ${flashcards.length}`;
            document.getElementById("flashcard-inner").classList.remove("flipped");
        }
    
        function flipCard() {
            document.getElementById("flashcard-inner").classList.toggle("flipped");
        }
    
        function nextCard() {
            if (currentIndex < flashcards.length - 1) {
                currentIndex++;
                showCard();
            }
        }
    
        function prevCard() {
            if (currentIndex > 0) {
                currentIndex--;
                showCard();
            }
        }
    
        function logout() {
            localStorage.removeItem("deckName");
            localStorage.removeItem("savedDeck");
            localStorage.removeItem("username");
            window.location.href = "login.html";
        }
    </script>
    
    
</body>
</html>
